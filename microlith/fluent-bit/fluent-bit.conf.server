@include /fluent-bit/etc/couchbase/service.conf
    HTTP_Port    2020

@include /fluent-bit/etc/couchbase/in-audit-log.conf
@include /fluent-bit/etc/couchbase/in-xdcr-log.conf
@include /fluent-bit/etc/couchbase/in-indexer-projector-log.conf
@include /fluent-bit/etc/couchbase/in-memcached-log.conf
@include /fluent-bit/etc/couchbase/in-erlang-multiline-log.conf
@include /fluent-bit/etc/couchbase/in-java-log.conf
@include /fluent-bit/etc/couchbase/in-eventing-fts-log.conf
@include /fluent-bit/etc/couchbase/in-http-log.conf
@include /fluent-bit/etc/couchbase/in-rebalance-report.conf

# DISABLE if not in K8S:
# Add in common info
# @include /fluent-bit/etc/couchbase/filter-add-common-info.conf

@include /fluent-bit/etc/couchbase/filter-handle-levels.conf
@include /fluent-bit/etc/couchbase/out-stdout.conf

# Send to loki: refer to configuration guide
# Do not make too many labels: https://grafana.com/blog/2020/08/27/the-concise-guide-to-labels-in-loki/
# Do the work in Loki later via queries
[OUTPUT]
    name loki
    alias loki_server
    match *
    host couchbase-grafana
    labels job=couchbase-fluentbit
    label_keys $filename,$level
    Retry_limit 0

# Send to file replicator
[OUTPUT]
    name forward
    alias file_replication_output_server
    match *
    host couchbase-grafana
    Port 24224
    Require_ack_response true
    Retry_limit 0